# SHERE-2_from_appro_to_mass

*Первичные параметры*

1. Тип первичной частицы;
2. Энергия первичной частицы;
3. Модель ядро-ядерного взаимодействия;
4. Модель атмосферы;
5. Высота расположения детектора;
6. Угол падения оси ливня / зенитный угол.
   
Известны х,у -- координаты центров ФЭУ в телескопе.

В результате моделирования получаются числа фотоэлектронов в каждом из 109 ФЭУ (I).

Комбинация x,y,I представляет из себя образ или функцию пространственного распределения (ФПР, оно же LDF).

# I Аппроксимация ФПР

В качестве входных файлов выступают "mosaic_hits*". 

Значения первичных параметров меняются в файле "Path_to_data". 
Аппроксимация выполняется в файле "Appro_mh_with_BG_square_with_aberr". 



Для запуска необходимо запустить файл "Launch_appro".

Выходными файлами являются файлы вида "param_bg_m01_q2_10PeV_10-20_900m_Fe.txt", в которых записаны параметры аппркосимирующей функции p0,p1,p2,p3,p4,s и некоторые других полезные значений. А именно в оглавлении файла присутствует строка ,idx,fcn,p0,p1,p2,p3,p4,s,x0,y0,I_max,sum,Rc_snow,Int,err_Int. Где idx -- индекс события mosaic_hits* (если клон №12 события №5, то индекс будет равен 512), fcn -- среднеквадратичное отклонение аппроксимации от смоделированных данных, далее идут параметры аппроксимирующей функции, x0,y0 -- координаты центра оси ливня на мозаике ФЭУ, рассчитанные в процессе аппроксимации, I_max -- максимальное число фотоэлектронов в ФЭУ, sum -- суммарное число фотоэлектронов во всех ФЭУ, Rc_snow (R_t в старом варианте) -- расстояние от оси детектора до центра оси ливня на снегу, Int -- интеграл по фПР от 0 до 200мм, err_Int -- ошибка этого интеграла.

